import{d as R,H as q,c as P,r as n,w as e,a as t,f as o,t as s,b as a,g as $,j as le,F as oe,o as C,e as p,i as ne,k as Y,I as j,m as ae,J as re,_ as ie}from"./BRxAjNlp.js";const se={class:"text-h6"},de=R({__name:"OrderDetailsModal",props:{order:{type:Object,required:!0},show:{type:Boolean,default:!1}},emits:["close","update:show"],setup(i,{emit:D}){const V=i,x=D,b=()=>{x("close"),x("update:show",!1)};return q(()=>V.show,_=>{_||x("close")}),(_,l)=>{const y=n("v-spacer"),u=n("v-icon"),S=n("v-btn"),N=n("v-card-title"),I=n("v-list-subheader"),c=n("v-list-item-title"),v=n("v-list-item-subtitle"),f=n("v-list-item"),E=n("v-chip"),z=n("v-list"),g=n("v-col"),w=n("v-row"),M=n("v-divider"),F=n("v-table"),T=n("v-card-text"),m=n("v-card-actions"),r=n("v-card"),U=n("v-dialog");return C(),P(U,{"model-value":i.show,"onUpdate:modelValue":l[0]||(l[0]=k=>_.$emit("update:show",k)),"max-width":"900px"},{default:e(()=>[t(r,null,{default:e(()=>[t(N,{class:"text-h5 bg-primary text-white pa-4"},{default:e(()=>[o(" Dettaglio Ordine "+s(i.order.id)+" ",1),t(y),t(S,{icon:"",variant:"text",color:"white",onClick:b},{default:e(()=>[t(u,null,{default:e(()=>l[1]||(l[1]=[o("mdi-close")])),_:1})]),_:1})]),_:1}),t(T,{class:"pa-4"},{default:e(()=>[t(w,null,{default:e(()=>[t(g,{cols:"12",md:"6"},{default:e(()=>[t(z,null,{default:e(()=>[t(I,{class:"text-h6"},{default:e(()=>l[2]||(l[2]=[o("Informazioni Ordine")])),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[3]||(l[3]=[o("mdi-identifier")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[4]||(l[4]=[o("ID Ordine")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.id),1)]),_:1})]),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[5]||(l[5]=[o("mdi-calendar")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[6]||(l[6]=[o("Data Creazione")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.creationDate),1)]),_:1})]),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[7]||(l[7]=[o("mdi-truck-delivery")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[8]||(l[8]=[o("Data Consegna")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.deliveryDate),1)]),_:1})]),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[9]||(l[9]=[o("mdi-store")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[10]||(l[10]=[o("Mercato")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.market),1)]),_:1})]),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:i.order.status==="Completed"?"success":i.order.status==="Processing"?"primary":"warning"},{default:e(()=>l[11]||(l[11]=[o(" mdi-information ")])),_:1},8,["color"])]),default:e(()=>[t(c,null,{default:e(()=>l[12]||(l[12]=[o("Stato")])),_:1}),t(v,null,{default:e(()=>[t(E,{color:i.order.status==="Completed"?"success":i.order.status==="Processing"?"primary":"warning",size:"small"},{default:e(()=>[o(s(i.order.status),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),t(g,{cols:"12",md:"6"},{default:e(()=>[t(z,null,{default:e(()=>[t(I,{class:"text-h6"},{default:e(()=>l[13]||(l[13]=[o("Informazioni Cliente")])),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[14]||(l[14]=[o("mdi-account")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[15]||(l[15]=[o("Nome")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.clientName)+" "+s(i.order.clientSurname),1)]),_:1})]),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[16]||(l[16]=[o("mdi-identifier")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[17]||(l[17]=[o("ID Cliente")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.clientId),1)]),_:1})]),_:1}),t(f,null,{prepend:e(()=>[t(u,{color:"primary"},{default:e(()=>l[18]||(l[18]=[o("mdi-email")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[19]||(l[19]=[o("Email")])),_:1}),t(v,null,{default:e(()=>[o(s(i.order.email),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(M,{class:"my-4"}),t(w,null,{default:e(()=>[t(g,{cols:"12"},{default:e(()=>[l[21]||(l[21]=a("h3",{class:"text-h6 mb-3"},"Dettagli Pagamento",-1)),t(F,null,{default:e(()=>[l[20]||(l[20]=a("thead",null,[a("tr",null,[a("th",null,"Totale"),a("th",null,"Fees"),a("th",null,"Spedizione"),a("th",null,"Pagato"),a("th",null,"Metodo Pagamento")])],-1)),a("tbody",null,[a("tr",null,[a("td",se,"€"+s(i.order.total.toFixed(2)),1),a("td",null,"€"+s(i.order.fees.toFixed(2)),1),a("td",null,"€"+s(i.order.shipping.toFixed(2)),1),a("td",null,[t(u,{color:i.order.paid?"success":"error"},{default:e(()=>[o(s(i.order.paid?"mdi-check-circle":"mdi-close-circle"),1)]),_:1},8,["color"]),o(" "+s(i.order.paid?"Sì":"No"),1)]),a("td",null,s(i.order.paymentType),1)])])]),_:1})]),_:1})]),_:1}),t(M,{class:"my-4"}),t(w,null,{default:e(()=>[t(g,{cols:"12"},{default:e(()=>[l[22]||(l[22]=a("h3",{class:"text-h6 mb-3"},"Prodotti",-1)),a("p",null,s(i.order.products),1)]),_:1})]),_:1}),t(M,{class:"my-4"}),t(w,null,{default:e(()=>[t(g,{cols:"12"},{default:e(()=>[l[24]||(l[24]=a("h3",{class:"text-h6 mb-3"},"Venditori",-1)),t(F,null,{default:e(()=>[l[23]||(l[23]=a("thead",null,[a("tr",null,[a("th",null,"Nome Venditore"),a("th",null,"Totale")])],-1)),a("tbody",null,[(C(!0),$(oe,null,le(i.order.vendors,(k,O)=>(C(),$("tr",{key:O},[a("td",null,s(k.name),1),a("td",null,"€"+s(k.total.toFixed(2)),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),t(m,{class:"pa-4"},{default:e(()=>[t(y),t(S,{color:"primary",variant:"text",onClick:b},{default:e(()=>l[25]||(l[25]=[o(" Chiudi ")])),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),ue={class:"me-4"},me={class:"d-flex align-center flex-wrap gap-2",style:{width:"100%","max-width":"600px"}},ce=R({__name:"MonthlyOrders",setup(i){const D=p([]),V=p(!0),x=p(""),b=p(""),_=p(""),l=new Date().getFullYear(),y=p(new Date().getMonth()),u=p(l),S=Array.from({length:12},(m,r)=>({title:new Date(0,r).toLocaleString("it-IT",{month:"long"}),value:r})),N=Array.from({length:10},(m,r)=>l-5+r),I=[{title:"ID",key:"id",align:"start"},{title:"Stato",key:"status"},{title:"Data",key:"creationDate",class:"d-none d-sm-table-cell"},{title:"Cliente",key:"client"},{title:"Email",key:"email",class:"d-none d-md-table-cell"},{title:"Totale",key:"total",align:"end"},{title:"Pagato",key:"paid",align:"center",class:"d-none d-md-table-cell"},{title:"Pagamento",key:"payment",class:"d-none d-lg-table-cell"},{title:"Mercato",key:"market",class:"d-none d-lg-table-cell"},{title:"Azioni",key:"actions",align:"center",sortable:!1}],c=async()=>{V.value=!0,_.value="";try{const m=String(y.value+1).padStart(2,"0"),r=await re.getMonthlyOrders(m,String(u.value));D.value=r.orders||[],x.value=r.lastUpdate||new Date().toLocaleString("it-IT")}catch(m){console.error("Errore nel caricamento degli ordini:",m),_.value="Impossibile caricare i dati. Verifica la connessione.",D.value=[]}finally{V.value=!1}},v=p(!1),f=p(null),E=m=>{f.value=m,v.value=!0},z=()=>v.value=!1,g=m=>m==="Completato"?"success":m==="In elaborazione"?"warning":"error",w=m=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(m),M=()=>{},F=()=>alert("Funzionalità di esportazione PDF in fase di implementazione"),T=()=>c();return q([y,u],c),ne(c),(m,r)=>{const U=n("v-card-subtitle"),k=n("v-spacer"),O=n("v-select"),A=n("v-btn"),B=n("v-icon"),h=n("v-list-item-title"),L=n("v-list-item"),H=n("v-list"),J=n("v-menu"),G=n("v-card-title"),K=n("v-divider"),Q=n("v-text-field"),W=n("v-alert"),X=n("v-skeleton-loader"),Z=n("v-chip"),ee=n("v-data-table"),te=n("v-card");return C(),P(te,{elevation:"10"},{default:e(()=>[t(G,{class:"d-flex flex-wrap align-center pa-4"},{default:e(()=>[a("div",ue,[r[3]||(r[3]=a("h5",{class:"text-h5"},"Resoconto Ordini",-1)),t(U,{class:"ps-0"},{default:e(()=>[o("Ultimo aggiornamento: "+s(x.value),1)]),_:1})]),t(k),a("div",me,[t(O,{modelValue:y.value,"onUpdate:modelValue":r[0]||(r[0]=d=>y.value=d),items:j(S),label:"Mese","hide-details":"",variant:"outlined",density:"compact",class:"flex-grow-1",style:{"min-width":"140px"}},null,8,["modelValue","items"]),t(O,{modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=d=>u.value=d),items:j(N),label:"Anno","hide-details":"",variant:"outlined",density:"compact",class:"flex-grow-1",style:{"min-width":"120px"}},null,8,["modelValue","items"]),t(A,{icon:"mdi-refresh",onClick:T,title:"Aggiorna dati"}),t(J,null,{activator:e(({props:d})=>[t(A,ae({icon:"mdi-download"},d,{title:"Esporta dati"}),null,16)]),default:e(()=>[t(H,null,{default:e(()=>[t(L,{onClick:M},{default:e(()=>[t(h,null,{default:e(()=>[t(B,{start:""},{default:e(()=>r[4]||(r[4]=[o("mdi-file-delimited")])),_:1}),r[5]||(r[5]=o("Esporta CSV"))]),_:1})]),_:1}),t(L,{onClick:F},{default:e(()=>[t(h,null,{default:e(()=>[t(B,{start:""},{default:e(()=>r[6]||(r[6]=[o("mdi-file-pdf-box")])),_:1}),r[7]||(r[7]=o("Esporta PDF"))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),t(K),t(Q,{modelValue:b.value,"onUpdate:modelValue":r[2]||(r[2]=d=>b.value=d),label:"Cerca in tabella (cliente, email, stato...)","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"",class:"pa-2"},null,8,["modelValue"]),_.value?(C(),P(W,{key:0,type:"error",class:"ma-2",density:"compact",closable:""},{default:e(()=>[o(s(_.value),1)]),_:1})):Y("",!0),t(ee,{headers:I,items:D.value,search:b.value,loading:V.value,"item-value":"id",class:"elevation-0"},{loading:e(()=>[t(X,{type:"table-row@5"})]),"item.status":e(({value:d})=>[t(Z,{color:g(d),size:"small"},{default:e(()=>[o(s(d),1)]),_:2},1032,["color"])]),"item.total":e(({value:d})=>[o(s(w(d)),1)]),"item.paid":e(({value:d})=>[t(B,{color:d?"success":"error"},{default:e(()=>[o(s(d?"mdi-check-circle":"mdi-close-circle"),1)]),_:2},1032,["color"])]),"item.actions":e(({item:d})=>[t(A,{icon:"mdi-eye",variant:"text",color:"primary",size:"small",onClick:ve=>E(d)},null,8,["onClick"])]),"no-data":e(()=>r[8]||(r[8]=[a("div",{class:"pa-4 text-center"},"Nessun ordine trovato per il periodo selezionato.",-1)])),_:1},8,["items","search","loading"]),f.value?(C(),P(de,{key:1,order:f.value,show:v.value,onClose:z},null,8,["order","show"])):Y("",!0)]),_:1})}}}),pe=ie(ce,[["__scopeId","data-v-c0d23c00"]]);export{pe as M};
