{"version":3,"file":"B2BOrders.vue2.mjs","sources":["../../../../../components/dashboard/B2BOrders.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, computed, onMounted } from 'vue';\n\n// 1. TypeScript Interfaces per una struttura dati robusta e auto-documentante\ninterface OrderItem {\n  product: string;\n  quantity: number;\n  price: number;\n  total: number;\n}\n\ninterface B2BOrder {\n  id: string;\n  vendorId: string;\n  vendorName: string;\n  vendorType: string;\n  date: string;\n  total: number;\n  status: 'Completed' | 'Processing' | 'Pending';\n  paymentStatus: 'Paid' | 'Pending' | 'Not Paid';\n  paymentType: string;\n  items: OrderItem[];\n  deliveryDate: string;\n  recurring: boolean;\n  frequency: string;\n}\n\n// 2. Stato reattivo\nconst isLoading = ref(true);\nconst search = ref('');\nconst b2bOrders = ref<B2BOrder[]>([]);\nconst lastUpdate = ref('');\n\n// Filtri\nconst vendorTypes = ['Tutti', 'Ristorante', 'Trattoria', 'Hotel', 'Pizzeria', 'Catering'];\nconst orderStatuses = ['Tutti', 'Completed', 'Processing', 'Pending'];\nconst selectedVendorType = ref('Tutti');\nconst selectedStatus = ref('Tutti');\n\n// Modale\nconst selectedOrder = ref<B2BOrder | null>(null);\nconst showOrderDetails = ref(false);\n\n// 3. Headers per le v-data-table\nconst mainHeaders = [\n  { title: 'Venditore', key: 'vendorName', align: 'start' },\n  { title: 'Data Ordine', key: 'date', class: 'd-none d-md-table-cell' },\n  { title: 'Totale', key: 'total', align: 'end' },\n  { title: 'Stato Ordine', key: 'status', align: 'center' },\n  { title: 'Stato Pagamento', key: 'paymentStatus', align: 'center' },\n  { title: 'Ricorrente', key: 'recurring', align: 'center', class: 'd-none d-lg-table-cell' },\n  { title: 'Azioni', key: 'actions', align: 'center', sortable: false },\n];\n\nconst modalItemsHeaders = [\n    { title: 'Prodotto', key: 'product', align: 'start' },\n    { title: 'Quantità', key: 'quantity', align: 'end' },\n    { title: 'Prezzo Unitario', key: 'price', align: 'end' },\n    { title: 'Totale Riga', key: 'total', align: 'end' },\n];\n\n// 4. Logica di calcolo (Computed Properties)\nconst filteredData = computed(() => {\n  return b2bOrders.value.filter(order => {\n    const matchesVendorType = selectedVendorType.value === 'Tutti' || order.vendorType === selectedVendorType.value;\n    const matchesStatus = selectedStatus.value === 'Tutti' || order.status === selectedStatus.value;\n    return matchesVendorType && matchesStatus;\n  });\n});\n\nconst filteredTotals = computed(() => {\n  return filteredData.value.reduce((acc, order) => {\n    acc.totalOrders += 1;\n    acc.totalAmount += order.total;\n    if (order.paymentStatus === 'Paid') acc.paidAmount += order.total;\n    else acc.pendingAmount += order.total;\n    return acc;\n  }, { totalOrders: 0, totalAmount: 0, paidAmount: 0, pendingAmount: 0 });\n});\n\n// 5. Funzioni Helper e Azioni\nconst getOrderStatusColor = (status: B2BOrder['status']) => \n    ({ Completed: 'success', Processing: 'primary', Pending: 'warning' }[status]);\nconst getPaymentStatusColor = (status: B2BOrder['paymentStatus']) =>\n    ({ Paid: 'success', Pending: 'warning', 'Not Paid': 'error' }[status]);\n\nconst formatCurrency = (value: number) => new Intl.NumberFormat('it-IT', { style: 'currency', currency: 'EUR' }).format(value);\nconst formatDate = (dateString: string) => new Date(dateString).toLocaleDateString('it-IT');\n\nconst viewOrderDetails = (order: B2BOrder) => {\n  selectedOrder.value = order;\n  showOrderDetails.value = true;\n};\nconst closeOrderDetails = () => showOrderDetails.value = false;\n\nconst exportToCSV = () => { /* La tua logica CSV è corretta */ };\nconst exportToPDF = () => alert('Funzionalità PDF in sviluppo');\nconst refreshData = () => { lastUpdate.value = new Date().toLocaleString('it-IT'); };\n\n// 6. Lifecycle\nonMounted(() => {\n  setTimeout(() => {\n    b2bOrders.value = [ // Mock data\n        { id: 'B2B-001', vendorId: 'V001', vendorName: 'Ristorante Da Luigi', vendorType: 'Ristorante', date: '2025-10-11', total: 1250.75, status: 'Completed', paymentStatus: 'Paid', paymentType: 'Bonifico', items: [ { product: 'Pomodori San Marzano', quantity: 20, price: 3.50, total: 70.00 }, { product: 'Mozzarella di Bufala', quantity: 15, price: 8.50, total: 127.50 }, { product: 'Olio Extra Vergine', quantity: 10, price: 12.50, total: 125.00 } ], deliveryDate: '2025-10-13', recurring: true, frequency: 'Settimanale' },\n        { id: 'B2B-002', vendorId: 'V002', vendorName: 'Trattoria Bella Italia', vendorType: 'Trattoria', date: '2025-10-10', total: 980.50, status: 'Processing', paymentStatus: 'Pending', paymentType: 'Bonifico', items: [ { product: 'Parmigiano Reggiano', quantity: 5, price: 22.00, total: 110.00 }, { product: 'Prosciutto di Parma', quantity: 8, price: 18.50, total: 148.00 }, { product: 'Vino Rosso', quantity: 12, price: 15.00, total: 180.00 } ], deliveryDate: '2025-10-12', recurring: true, frequency: 'Bisettimanale' },\n        { id: 'B2B-003', vendorId: 'V003', vendorName: 'Hotel Milano', vendorType: 'Hotel', date: '2025-10-10', total: 1850.25, status: 'Completed', paymentStatus: 'Paid', paymentType: 'Carta di Credito', items: [ { product: 'Frutta Mista', quantity: 50, price: 2.50, total: 125.00 }, { product: 'Verdure Assortite', quantity: 40, price: 3.00, total: 120.00 }, { product: 'Formaggi Locali', quantity: 15, price: 10.00, total: 150.00 } ], deliveryDate: '2025-10-11', recurring: true, frequency: 'Giornaliero' },\n        { id: 'B2B-004', vendorId: 'V004', vendorName: 'Pizzeria Napoli', vendorType: 'Pizzeria', date: '2025-10-09', total: 750.00, status: 'Processing', paymentStatus: 'Pending', paymentType: 'Bonifico', items: [ { product: 'Farina Tipo 00', quantity: 30, price: 2.50, total: 75.00 }, { product: 'Pomodori Pelati', quantity: 40, price: 1.80, total: 72.00 }, { product: 'Mozzarella', quantity: 25, price: 5.00, total: 125.00 } ], deliveryDate: '2025-10-11', recurring: true, frequency: 'Settimanale' },\n        { id: 'B2B-005', vendorId: 'V005', vendorName: 'Catering Eventi', vendorType: 'Catering', date: '2025-10-08', total: 2500.00, status: 'Pending', paymentStatus: 'Not Paid', paymentType: 'Bonifico', items: [ { product: 'Carne Selezionata', quantity: 20, price: 25.00, total: 500.00 }, { product: 'Pesce Fresco', quantity: 15, price: 30.00, total: 450.00 }, { product: 'Vini Pregiati', quantity: 10, price: 35.00, total: 350.00 } ], deliveryDate: '2025-10-18', recurring: false, frequency: 'Una Tantum' }\n    ];\n    lastUpdate.value = new Date().toLocaleString('it-IT');\n    isLoading.value = false;\n  }, 1000);\n});\n</script>\n\n<template>\n  <v-card>\n    <v-card-item class=\"pa-4 pa-md-6\">\n      <div class=\"d-flex flex-wrap align-center gap-4\">\n        <div>\n          <h2 class=\"text-h5\">Gestione Ordini B2B</h2>\n          <p class=\"text-subtitle-1 text-medium-emphasis\">Filtra e analizza gli ordini business</p>\n        </div>\n        <v-spacer></v-spacer>\n        <div class=\"d-flex flex-wrap align-center gap-2\">\n          <v-select v-model=\"selectedVendorType\" :items=\"vendorTypes\" label=\"Tipo Venditore\" density=\"compact\" variant=\"outlined\" hide-details style=\"min-width: 150px;\"></v-select>\n          <v-select v-model=\"selectedStatus\" :items=\"orderStatuses\" label=\"Stato Ordine\" density=\"compact\" variant=\"outlined\" hide-details style=\"min-width: 150px;\"></v-select>\n          <v-menu>\n            <template v-slot:activator=\"{ props }\"><v-btn icon=\"mdi-dots-vertical\" v-bind=\"props\"></v-btn></template>\n            <v-list>\n              <v-list-item @click=\"refreshData\" prepend-icon=\"mdi-refresh\">Aggiorna</v-list-item>\n              <v-list-item @click=\"exportToCSV\" prepend-icon=\"mdi-file-delimited\">Esporta CSV</v-list-item>\n              <v-list-item @click=\"exportToPDF\" prepend-icon=\"mdi-file-pdf-box\">Esporta PDF</v-list-item>\n            </v-list>\n          </v-menu>\n        </div>\n      </div>\n\n      <v-row class=\"mt-4\">\n        <v-col v-for=\"item in [\n            { label: 'Ordini Filtrati', value: filteredTotals.totalOrders, format: (v) => v },\n            { label: 'Importo Totale', value: filteredTotals.totalAmount, format: formatCurrency, color: 'primary' },\n            { label: 'Importo Pagato', value: filteredTotals.paidAmount, format: formatCurrency, color: 'success' },\n            { label: 'Importo In Attesa', value: filteredTotals.pendingAmount, format: formatCurrency, color: 'warning' },\n        ]\" :key=\"item.label\" cols=\"12\" sm=\"6\" md=\"3\">\n          <v-card variant=\"tonal\" :color=\"item.color\" class=\"pa-4 text-center h-100\">\n            <div class=\"text-overline\">{{ item.label }}</div>\n            <div class=\"text-h4 font-weight-bold\">{{ item.format(item.value) }}</div>\n          </v-card>\n        </v-col>\n      </v-row>\n    </v-card-item>\n\n    <v-divider></v-divider>\n    \n    <v-text-field v-model=\"search\" label=\"Cerca per nome venditore o ID...\" prepend-inner-icon=\"mdi-magnify\" variant=\"solo-filled\" flat hide-details single-line></v-text-field>\n\n    <v-data-table\n      :headers=\"mainHeaders\"\n      :items=\"filteredData\"\n      :search=\"search\"\n      :loading=\"isLoading\"\n      item-value=\"id\"\n      class=\"elevation-0\"\n      :sort-by=\"[{ key: 'date', order: 'desc' }]\"\n    >\n      <template v-slot:loading><v-skeleton-loader type=\"table-row@5\"></v-skeleton-loader></template>\n      \n      <template v-slot:item.vendorName=\"{ item }\">\n        <div class=\"font-weight-bold\">{{ item.vendorName }}</div>\n        <div class=\"text-caption\">{{ item.vendorType }}</div>\n      </template>\n      \n      <template v-slot:item.total=\"{ value }\"><span class=\"font-weight-bold\">{{ formatCurrency(value) }}</span></template>\n      \n      <template v-slot:item.status=\"{ value }\"><v-chip :color=\"getOrderStatusColor(value)\" size=\"small\">{{ value }}</v-chip></template>\n      <template v-slot:item.paymentStatus=\"{ value }\"><v-chip :color=\"getPaymentStatusColor(value)\" size=\"small\">{{ value }}</v-chip></template>\n\n      <template v-slot:item.recurring=\"{ item }\">\n        <v-icon :color=\"item.recurring ? 'success' : 'grey-lighten-1'\">\n            {{ item.recurring ? 'mdi-check-circle' : 'mdi-close-circle' }}\n        </v-icon>\n        <span class=\"ms-1 text-caption\">{{ item.frequency }}</span>\n      </template>\n\n      <template v-slot:item.actions=\"{ item }\">\n        <v-btn icon=\"mdi-eye-outline\" variant=\"text\" size=\"small\" @click=\"viewOrderDetails(item)\"></v-btn>\n      </template>\n\n      <template v-slot:no-data><div class=\"pa-4 text-center\">Nessun ordine trovato con i filtri attuali.</div></template>\n    </v-data-table>\n\n    <v-dialog v-model=\"showOrderDetails\" max-width=\"900px\" scrollable>\n      <v-card v-if=\"selectedOrder\">\n        <v-card-title class=\"d-flex align-center pa-4\">\n          <span class=\"text-h5\">Dettaglio Ordine {{ selectedOrder.id }}</span>\n          <v-spacer></v-spacer>\n          <v-btn icon=\"mdi-close\" variant=\"text\" @click=\"closeOrderDetails\"></v-btn>\n        </v-card-title>\n        <v-divider></v-divider>\n        \n        <v-card-text>\n          <v-row>\n            <v-col cols=\"12\" md=\"6\">\n              <div class=\"text-overline\">Informazioni Ordine</div>\n              <v-list-item :title=\"selectedOrder.id\" subtitle=\"ID Ordine\" prepend-icon=\"mdi-identifier\"></v-list-item>\n              <v-list-item :title=\"formatDate(selectedOrder.date)\" subtitle=\"Data Ordine\" prepend-icon=\"mdi-calendar-start\"></v-list-item>\n              <v-list-item :title=\"formatDate(selectedOrder.deliveryDate)\" subtitle=\"Data Consegna\" prepend-icon=\"mdi-truck-delivery\"></v-list-item>\n            </v-col>\n            <v-col cols=\"12\" md=\"6\">\n              <div class=\"text-overline\">Informazioni Venditore</div>\n              <v-list-item :title=\"selectedOrder.vendorName\" :subtitle=\"selectedOrder.vendorId\" prepend-icon=\"mdi-storefront-outline\"></v-list-item>\n              <v-list-item :title=\"selectedOrder.vendorType\" subtitle=\"Tipo Venditore\" prepend-icon=\"mdi-tag-outline\"></v-list-item>\n              <v-list-item :title=\"selectedOrder.frequency\" :subtitle=\"`Ordine ${selectedOrder.recurring ? 'ricorrente' : 'singolo'}`\" prepend-icon=\"mdi-sync\"></v-list-item>\n            </v-col>\n          </v-row>\n          <v-divider class=\"my-4\"></v-divider>\n          \n          <h3 class=\"text-h6 mb-2\">Prodotti Ordinati</h3>\n          <v-data-table\n            :headers=\"modalItemsHeaders\"\n            :items=\"selectedOrder.items\"\n            density=\"compact\"\n            class=\"border rounded\"\n          >\n            <template v-slot:item.price=\"{ value }\">{{ formatCurrency(value) }}</template>\n            <template v-slot:item.total=\"{ value }\">{{ formatCurrency(value) }}</template>\n          </v-data-table>\n        </v-card-text>\n        \n        <v-divider></v-divider>\n        <v-card-actions class=\"pa-4\">\n            <div class=\"text-h6\">Totale: <span class=\"font-weight-bold\">{{ formatCurrency(selectedOrder.total) }}</span></div>\n            <v-spacer></v-spacer>\n            <v-btn color=\"primary\" variant=\"tonal\" @click=\"closeOrderDetails\">Chiudi</v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </v-card>\n</template>\n\n<style scoped>\n.gap-2 { gap: 8px; }\n.gap-4 { gap: 16px; }\n</style>"],"names":[],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}