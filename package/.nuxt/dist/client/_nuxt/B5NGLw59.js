import{d as Y,w as j,c as n,e as N,f as V,i as e,j as t,l as o,u as s,k as a,m as L,s as ee,F as te,r as f,a as le,M as oe,v as $,q as ne,_ as ae}from"./CCcdX0hl.js";const re={class:"text-h6"},ie=Y({__name:"OrderDetailsModal",props:{order:{type:Object,required:!0},show:{type:Boolean,default:!1}},emits:["close","update:show"],setup(r,{emit:M}){const S=r,w=M,k=()=>{w("close"),w("update:show",!1)};return j(()=>S.show,_=>{_||w("close")}),(_,l)=>{const y=n("v-spacer"),m=n("v-icon"),z=n("v-btn"),E=n("v-card-title"),C=n("v-list-subheader"),c=n("v-list-item-title"),v=n("v-list-item-subtitle"),p=n("v-list-item"),T=n("v-chip"),O=n("v-list"),x=n("v-col"),D=n("v-row"),F=n("v-divider"),P=n("v-table"),u=n("v-card-text"),i=n("v-card-actions"),g=n("v-card"),U=n("v-dialog");return V(),N(U,{"model-value":r.show,"onUpdate:modelValue":l[0]||(l[0]=b=>_.$emit("update:show",b)),"max-width":"900px"},{default:e(()=>[t(g,null,{default:e(()=>[t(E,{class:"text-h5 bg-primary text-white pa-4"},{default:e(()=>[o(" Dettaglio Ordine "+s(r.order.id)+" ",1),t(y),t(z,{icon:"",variant:"text",color:"white",onClick:k},{default:e(()=>[t(m,null,{default:e(()=>l[1]||(l[1]=[o("mdi-close")])),_:1})]),_:1})]),_:1}),t(u,{class:"pa-4"},{default:e(()=>[t(D,null,{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[t(O,null,{default:e(()=>[t(C,{class:"text-h6"},{default:e(()=>l[2]||(l[2]=[o("Informazioni Ordine")])),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[3]||(l[3]=[o("mdi-identifier")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[4]||(l[4]=[o("ID Ordine")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.id),1)]),_:1})]),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[5]||(l[5]=[o("mdi-calendar")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[6]||(l[6]=[o("Data Creazione")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.creationDate),1)]),_:1})]),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[7]||(l[7]=[o("mdi-truck-delivery")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[8]||(l[8]=[o("Data Consegna")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.deliveryDate),1)]),_:1})]),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[9]||(l[9]=[o("mdi-store")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[10]||(l[10]=[o("Mercato")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.market),1)]),_:1})]),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:r.order.status==="Completed"?"success":r.order.status==="Processing"?"primary":"warning"},{default:e(()=>l[11]||(l[11]=[o(" mdi-information ")])),_:1},8,["color"])]),default:e(()=>[t(c,null,{default:e(()=>l[12]||(l[12]=[o("Stato")])),_:1}),t(v,null,{default:e(()=>[t(T,{color:r.order.status==="Completed"?"success":r.order.status==="Processing"?"primary":"warning",size:"small"},{default:e(()=>[o(s(r.order.status),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[t(O,null,{default:e(()=>[t(C,{class:"text-h6"},{default:e(()=>l[13]||(l[13]=[o("Informazioni Cliente")])),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[14]||(l[14]=[o("mdi-account")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[15]||(l[15]=[o("Nome")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.clientName)+" "+s(r.order.clientSurname),1)]),_:1})]),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[16]||(l[16]=[o("mdi-identifier")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[17]||(l[17]=[o("ID Cliente")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.clientId),1)]),_:1})]),_:1}),t(p,null,{prepend:e(()=>[t(m,{color:"primary"},{default:e(()=>l[18]||(l[18]=[o("mdi-email")])),_:1})]),default:e(()=>[t(c,null,{default:e(()=>l[19]||(l[19]=[o("Email")])),_:1}),t(v,null,{default:e(()=>[o(s(r.order.email),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(F,{class:"my-4"}),t(D,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[l[21]||(l[21]=a("h3",{class:"text-h6 mb-3"},"Dettagli Pagamento",-1)),t(P,null,{default:e(()=>[l[20]||(l[20]=a("thead",null,[a("tr",null,[a("th",null,"Totale"),a("th",null,"Fees"),a("th",null,"Spedizione"),a("th",null,"Pagato"),a("th",null,"Metodo Pagamento")])],-1)),a("tbody",null,[a("tr",null,[a("td",re,"€"+s(r.order.total.toFixed(2)),1),a("td",null,"€"+s(r.order.fees.toFixed(2)),1),a("td",null,"€"+s(r.order.shipping.toFixed(2)),1),a("td",null,[t(m,{color:r.order.paid?"success":"error"},{default:e(()=>[o(s(r.order.paid?"mdi-check-circle":"mdi-close-circle"),1)]),_:1},8,["color"]),o(" "+s(r.order.paid?"Sì":"No"),1)]),a("td",null,s(r.order.paymentType),1)])])]),_:1})]),_:1})]),_:1}),t(F,{class:"my-4"}),t(D,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[l[22]||(l[22]=a("h3",{class:"text-h6 mb-3"},"Prodotti",-1)),a("p",null,s(r.order.products),1)]),_:1})]),_:1}),t(F,{class:"my-4"}),t(D,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[l[24]||(l[24]=a("h3",{class:"text-h6 mb-3"},"Venditori",-1)),t(P,null,{default:e(()=>[l[23]||(l[23]=a("thead",null,[a("tr",null,[a("th",null,"Nome Venditore"),a("th",null,"Totale")])],-1)),a("tbody",null,[(V(!0),L(te,null,ee(r.order.vendors,(b,I)=>(V(),L("tr",{key:I},[a("td",null,s(b.name),1),a("td",null,"€"+s(b.total.toFixed(2)),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{class:"pa-4"},{default:e(()=>[t(y),t(z,{color:"primary",variant:"text",onClick:k},{default:e(()=>l[25]||(l[25]=[o(" Chiudi ")])),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),se={class:"me-4"},de={class:"d-flex align-center flex-wrap gap-2",style:{width:"100%","max-width":"600px"}},ue=Y({__name:"MonthlyOrders",setup(r){const M=f([]),S=f(!0),w=f(""),k=f(""),_=f(""),l=f(0),y=f(0),m=f([]),z=f([]);le(()=>{const u=new Date().getFullYear();l.value=new Date().getMonth(),y.value=u,m.value=Array.from({length:12},(i,g)=>({title:new Date(0,g).toLocaleString("it-IT",{month:"long"}),value:g})),z.value=Array.from({length:10},(i,g)=>u-5+g),C()});const E=[{title:"ID",key:"id",align:"start"},{title:"Stato",key:"status"},{title:"Data",key:"creationDate",class:"d-none d-sm-table-cell"},{title:"Cliente",key:"client"},{title:"Email",key:"email",class:"d-none d-md-table-cell"},{title:"Totale",key:"total",align:"end"},{title:"Pagato",key:"paid",align:"center",class:"d-none d-md-table-cell"},{title:"Pagamento",key:"payment",class:"d-none d-lg-table-cell"},{title:"Mercato",key:"market",class:"d-none d-lg-table-cell"},{title:"Azioni",key:"actions",align:"center",sortable:!1}],C=async()=>{S.value=!0,_.value="";try{const u=String(l.value+1).padStart(2,"0"),i=await oe.getMonthlyOrders(u,String(y.value));M.value=i.orders||[],w.value=i.lastUpdate||new Date().toLocaleString("it-IT")}catch(u){console.error("Errore nel caricamento degli ordini:",u),_.value="Impossibile caricare i dati. Verifica la connessione.",M.value=[]}finally{S.value=!1}},c=f(!1),v=f(null),p=u=>{v.value=u,c.value=!0},T=()=>c.value=!1,O=u=>u==="Completato"?"success":u==="In elaborazione"?"warning":"error",x=u=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(u),D=()=>{},F=()=>alert("Funzionalità di esportazione PDF in fase di implementazione"),P=()=>C();return j([l,y],C),(u,i)=>{const g=n("v-card-subtitle"),U=n("v-spacer"),b=n("v-select"),I=n("v-btn"),A=n("v-icon"),B=n("v-list-item-title"),h=n("v-list-item"),q=n("v-list"),R=n("v-menu"),G=n("v-card-title"),H=n("v-divider"),J=n("v-text-field"),K=n("v-alert"),Q=n("v-skeleton-loader"),W=n("v-chip"),X=n("v-data-table"),Z=n("v-card");return V(),N(Z,{elevation:"10"},{default:e(()=>[t(G,{class:"d-flex flex-wrap align-center pa-4"},{default:e(()=>[a("div",se,[i[3]||(i[3]=a("h5",{class:"text-h5"},"Resoconto Ordini",-1)),t(g,{class:"ps-0"},{default:e(()=>[o("Ultimo aggiornamento: "+s(w.value),1)]),_:1})]),t(U),a("div",de,[t(b,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=d=>l.value=d),items:m.value,label:"Mese","hide-details":"",variant:"outlined",density:"compact",class:"flex-grow-1",style:{"min-width":"140px"}},null,8,["modelValue","items"]),t(b,{modelValue:y.value,"onUpdate:modelValue":i[1]||(i[1]=d=>y.value=d),items:z.value,label:"Anno","hide-details":"",variant:"outlined",density:"compact",class:"flex-grow-1",style:{"min-width":"120px"}},null,8,["modelValue","items"]),t(I,{icon:"mdi-refresh",onClick:P,title:"Aggiorna dati"}),t(R,null,{activator:e(({props:d})=>[t(I,ne({icon:"mdi-download"},d,{title:"Esporta dati"}),null,16)]),default:e(()=>[t(q,null,{default:e(()=>[t(h,{onClick:D},{default:e(()=>[t(B,null,{default:e(()=>[t(A,{start:""},{default:e(()=>i[4]||(i[4]=[o("mdi-file-delimited")])),_:1}),i[5]||(i[5]=o("Esporta CSV"))]),_:1})]),_:1}),t(h,{onClick:F},{default:e(()=>[t(B,null,{default:e(()=>[t(A,{start:""},{default:e(()=>i[6]||(i[6]=[o("mdi-file-pdf-box")])),_:1}),i[7]||(i[7]=o("Esporta PDF"))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),t(H),t(J,{modelValue:k.value,"onUpdate:modelValue":i[2]||(i[2]=d=>k.value=d),label:"Cerca in tabella (cliente, email, stato...)","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"",class:"pa-2"},null,8,["modelValue"]),_.value?(V(),N(K,{key:0,type:"error",class:"ma-2",density:"compact",closable:""},{default:e(()=>[o(s(_.value),1)]),_:1})):$("",!0),t(X,{headers:E,items:M.value,search:k.value,loading:S.value,"item-value":"id",class:"elevation-0"},{loading:e(()=>[t(Q,{type:"table-row@5"})]),"item.status":e(({value:d})=>[t(W,{color:O(d),size:"small"},{default:e(()=>[o(s(d),1)]),_:2},1032,["color"])]),"item.total":e(({value:d})=>[o(s(x(d)),1)]),"item.paid":e(({value:d})=>[t(A,{color:d?"success":"error"},{default:e(()=>[o(s(d?"mdi-check-circle":"mdi-close-circle"),1)]),_:2},1032,["color"])]),"item.actions":e(({item:d})=>[t(I,{icon:"mdi-eye",variant:"text",color:"primary",size:"small",onClick:me=>p(d)},null,8,["onClick"])]),"no-data":e(()=>i[8]||(i[8]=[a("div",{class:"pa-4 text-center"},"Nessun ordine trovato per il periodo selezionato.",-1)])),_:1},8,["items","search","loading"]),v.value?(V(),N(ie,{key:1,order:v.value,show:c.value,onClose:T},null,8,["order","show"])):$("",!0)]),_:1})}}}),ve=ae(ue,[["__scopeId","data-v-3f14a087"]]);export{ve as M};
